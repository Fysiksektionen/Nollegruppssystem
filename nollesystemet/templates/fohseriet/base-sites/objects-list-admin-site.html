{% extends "fohseriet/base-sites/base-content.html" %}
{% load crispy_forms_tags %}
{% load crispy_forms_filters %}

{% block content-indented %}
    {% include "common/elements/back-button.html" %}
    <div class="container-fluid p-4">
        {% block information %}{% endblock %}
    </div>

    {% if form %}
        <hr style="height: 2px; border-width: 0; color: gray; background-color: gray;">
        <h2>Administrera:</h2>
        {% if file_upload_success is not None %}
            <div class="alert alert-{% if file_upload_success %}success{% else %}danger{% endif %}" role="alert">
                {{ file_upload_information|linebreaks }}
            </div>
        {% endif %}
        <div class="d-flex flex-column col-xl-8 col-lg-10 p-4">
            {% crispy form %}
        </div>

    {% endif %}

    <hr style="height: 2px; border-width: 0; color: gray; background-color: gray;">
    <h2>Visa/Redigera:</h2>
    <div class="container-fluid p-4">
        {% block object_list %}{% endblock %}
    </div>

{% endblock %}

{% block extrapostscript %}
    {{ block.super }}
    <script>
        {#$( document ).ready(function() {#}
        {#    update_active_rows_table();#}
        {# });#}

        {#$('#search-bar').on("keyup", function () {#}
        {#    update_active_rows_table();#}
        {# }); #}
        {##}
        {#$('#filter-elements button').click(function () {#}
        {#    $(this).toggleClass('active-button');#}
        {#    update_active_rows_table();#}
        {# }); #}
        {##}
        {#function check_all_button_constraints(buttonList, rowElement) {#}
        {#    var tempBool = false;#}
        {#    for (var i = 0; i < buttonList.length; ++i) {#}
        {#        var buttonElement = buttonList[i];#}
        {#        var groupName = buttonElement.dataset.groupName;#}
        {#        var columnId = '#' + buttonElement.dataset.columnId;#}
        {#        var isActive = $(buttonElement).hasClass('active-button');#}
        {#        var containsGroup = $(rowElement.find(columnId)[0]).text().indexOf(groupName) > -1;#}
        {#        if (isActive && containsGroup) {#}
        {#            tempBool = true;#}
        {#        }#}
        {#    }#}
        {#    return tempBool;#}
        {# } #}
        {##}
        {#function update_active_rows_table() {#}
        {#    var tableId = '#user-table-body';#}
        {#    var searchValue = $('#search-bar').val().toLowerCase();#}
        {#    var should_be_active = new Array($(tableId + " tr").length);#}
        {#    for (var i = 0; i < should_be_active.length; ++i) { should_be_active[i] = true; }#}
        {##}
        {#    var nolle_group_buttons = $('#nolle-groups button');#}
        {#    var user_type_buttons = $('#user-types button');#}
        {##}
        {#    $(tableId + " tr").filter(function (index, element) {#}
        {#        $(element).show();#}
        {#        if (!(($(this).text().toLowerCase().indexOf(searchValue) > -1) &&#}
        {#            check_all_button_constraints(nolle_group_buttons, $(this)) &&#}
        {#            check_all_button_constraints(user_type_buttons, $(this)))) {#}
        {#            $(element).hide();#}
        {#        }#}
        {##}
        {#    });#}
        {# } #}
    </script>
{% endblock %}